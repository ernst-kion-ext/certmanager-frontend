<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Certmanager Codesign - Certificate List</title>
    <link rel="stylesheet" href="css/styles.css">
    <script src="js/loadCertificates.js"></script>
    <script src="js/certificate-list.js"></script>
    <script src="js/app.js"></script>
</head>
<body>
    <h1>Certificate Manager</h1>

    <div>
        <label for="server-select">Choose server:</label>
        <select id="server-select">
            <option value="https://vault.kiongroup.com:8200/">Production</option>
            <option value="https://vault-uat.kiongroup.com:8200/">UAT (Testing)</option>
            <option value="http://localhost:8000/">Localhost</option>
            <option value="https://vault.seele-00.asuka-shikinami.club/">Ernst</option>
        </select>
    </div>

    <div>
        <label for="api-key-input">API Key:</label>
        <input type="text" id="api-key-input" placeholder="Enter API key for certmanager ui server">
        <label for="certamount-input" style="margin-left:10px;">Max certificates:</label>
        <input type="number" id="certamount-input" min="1" style="width:80px;" placeholder="All">
        <button id="fetch-certificates-btn" onclick="fetchCertificates()">Submit</button>
    </div>

    <h2>Certificate Table</h2>
    <div style="margin-bottom: 10px;">
        <input
            type="text"
            id="filter-input"
            placeholder="Search all fields"
            style="width: 50%; padding: 4px;"
        >
    </div>
    <table>
      <thead>
        <tr>
          <th>Subject</th>
          <th>Not Valid Before</th>
          <th>Not Valid After</th>
          <th>Days Left</th>
          <th>Key Usage</th>
          <th>Issuer</th>
          <th>Status</th>
          <th>Fingerprint</th>
          <th>Signature Hash Algorithm</th>
          <th>Public Key Type</th>
          <th>Public Key Size</th>
          <th>Signature</th>
        </tr>
        <tr id="column-search-row"></tr>
      </thead>
      <tbody id="certificates-body"></tbody>
    </table>

    <!-- Signature Modal -->
    <div id="signature-modal" style="display:none; position:fixed; top:0; left:0; width:100vw; height:100vh; background:rgba(0,0,0,0.5); z-index:1000; align-items:center; justify-content:center;">
      <div id="signature-modal-content" style="background:#fff; padding:24px; border-radius:8px; max-width:90vw; max-height:80vh; overflow:auto; position:relative; box-shadow:0 2px 16px rgba(0,0,0,0.3);">
        <button id="signature-modal-close" style="position:absolute; top:8px; right:8px; font-size:20px; background:none; border:none; cursor:pointer;">&times;</button>
        <h3>Certificate Signature</h3>
        <pre id="signature-modal-text" style="white-space:pre-wrap; word-break:break-all; margin-bottom:16px;"></pre>
        <button id="signature-modal-copy">Copy to Clipboard</button>
        <span id="signature-modal-copied" style="margin-left:10px; color:green; display:none;">Copied!</span>
      </div>
    </div>
</body>
</html>